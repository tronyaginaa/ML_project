# Генерация стихов в стиле определенного автора.
## Описание задачи
Вход - строка либо четверочтишие
Выход - сгенерированное стихотворение

Датасет – сборник стихов Есенина. 
## Описание проделанной работы

Изначально была идея попробовать добиться результатов используя стандартные нейросетевые архитектуры. Очевидно, что нужно было выбрать архитектуру с «памятью». Выбор пал на RNN так как :

* Стихи представляют собой последовательность слов или символов.
* RNN спроектированы для работы с последовательными данными, благодаря своей способности запоминать предыдущее состояние и использовать его для обработки следующего входа.

### Проделанные шаги

1. Взята библиотечная реализация (со стандартными параметрами) и дообучена на 5к итерациях на стихах Есенина
2. Для улучшения результатов были опробованы:
⋅⋅* Сетка параметров (количество слоёв, размер бача, оптимизатор)
⋅⋅* Использование других embedding-ов (label encoder, one hot encoder, bag of words, word2vec)
⋅⋅* Изменение температуры

Результаты полученные в ходе улучшения модели не привели к желаемым результатам, поэтому было решено изменить модель на open-source модель ruGPT-3.5, т.к.

* Модель хорошо умеет работать с русским языком, что необходимо для сохранения рифмы в стихотворениях
* Есть готовая квантованная реализация на hugging face

### Проделанные шаги

1. Протестирована реализация из коробки. С различными промптами (few shots)
3. Произведена попытка дообучить модель, провалившаяся из-за особенностей взаимодействия квантованной модели с дефолтным классом Trainer
4. Принято решение использовать модель LoRa для дообучения
⋅⋅1. Была использована готовая реализация (https://github.com/qwopqwop200/gptqlora)
⋅⋅2. Видоизменен стандартный метод библиотеки, т.к. gptqlora не поддерживала кастомные датасеты
⋅⋅3. Пока не работает;(

## Полученные результаты
Жирным шрифтом выделены данные, подаваемые на вход.
### RNN (дефолтные параметры, temp=0.5)
__пускай я порою от спирта вымок__
ты с утравот неблистой пощенный стары. в солько любать на пона,
на крого тек у стариваю сыль.
разалянье проговет.

### RNN
__пускай я порою от спирта вымок__
не спаивать сердце стравит страдать с половиной
пускай не люблю жизть
лелея весну

### ruGpt(few shot)


__Приветствую тебя, пустынный уголок,__ 
__Приют спокойствия, трудов и вдохновенья,__ 
__Где льется дней моих невидимый поток__
На лоне счастья и забвенья.
Отец семейства
Моя мать
И неженка Наташа, Дошкольник крупный Федька И психолог Саша



